---
# tasks file for system_user_lock

 - name: Fetch entire system user list
   sap_function_call:
     BAPI_USER_LOCK:
       fetch: users
   register: users

 - debug: var=users

 - name: Fetch existing Administer locked user list
   sap_function_call:
     BAPI_USER_LOCK:
       fetch: locked_users
   register: locked_users

 - debug: var=locked_users

 - name: Lock Users
   sap_function_call:
     BAPI_USER_LOCK:
       lock_users:
         exception_list: "{{ exception_list }}"
         action: lock
   register: lock

 - debug: var=lock

 - name: Unlock Users
   sap_function_call:
     BAPI_USER_LOCK:
       lock_users:
         exception_list: ['SAP*']
         action: unlock
   register: unlock

 - debug: var=unlock


