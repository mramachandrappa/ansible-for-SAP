---
 - hosts: all
   vars:
     ansible_connection: local
     ansible_python_interpreter: /usr/bin/python3
   tasks:
     - name: Fetch sys_params (client, sid, bin_path, trans_val, sid_ctc_val)
       sap_function_call:
         FETCH: sys_params
       register: sys_params

     - debug: var=sys_params

 - hosts: all
   vars:
      config_file_path: "{{ lookup('env','HOME') }}/system_refresh/{{ target_sap_sid }}/.config/sap_config.ini"
      ansible_user: "{{ lookup('ini', 'remote_ssh_user section=SAP file={{ config_file_path }} ') | lower }}"
   roles:
     - role: custom_programs_import
       vars:
         client: "{{ lookup('ini', 'client section=SAP file={{ config_file_path }} ') }}"
         bin_path: "{{ sys_params.meta.stdout.bin_path }}"
         cofiles_path: "{{ sys_params.meta.stdout.co_files }}"
         data_path: "{{ sys_params.meta.stdout.data_path }}"

